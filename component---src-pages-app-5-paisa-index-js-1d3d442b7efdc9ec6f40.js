"use strict";(self.webpackChunkkaagzi=self.webpackChunkkaagzi||[]).push([[918],{2164:function(e,t,r){r.d(t,{A:function(){return I}});var n=r(6540),o=r(1298),a=r(1381),s=r(2476),i=r(7432),c=r(5832);const l=(0,n.createContext)({id:null,name:null,accessToken:null,checkIfAccessTokenIsAlive:()=>{},chkIf5paisaUserIsLoggedIn:()=>{},logOut:()=>{}});function u(e){let{children:t}=e;const{0:r,1:u}=(0,n.useState)(!1),{0:h,1:d}=(0,n.useState)(null),{0:m,1:p}=(0,n.useState)(null),{0:g,1:y}=(0,n.useState)(null),{notify:f}=(0,n.useContext)(o._),w=(0,n.useContext)(a.M),b=(0,n.useContext)(s.d),k=(0,n.useRef)(null),E=()=>{u(!1),d(null),p(null),y(null),k.current=null},S=async()=>{const e=localStorage.getItem("fivePaisaUser");if(!e)return E(),!1;const t=JSON.parse(e);return v(t.t)?(d(t.atk),p(t.id),y(t.nm),t):(E(),localStorage.removeItem("fivePaisaUser"),!1)},v=e=>{try{if(!e){const t=localStorage.getItem("fivePaisaUser");if(t){const r=JSON.parse(t);Object.prototype.hasOwnProperty.call(r,"t")&&!isNaN(r.t)&&(e=r.t)}}if(!e)return!1;const t=new Date(new Date(e).toLocaleString("en-US",{timeZone:"Asia/Kolkata"})),r=new Date((new Date).toLocaleString("en-US",{timeZone:"Asia/Kolkata"}));return r.getFullYear()===t.getFullYear()&&r.getMonth()===t.getMonth()&&r.getDate()===t.getDate()}catch(t){return!1}},x=e=>{if(e.source.location.href.startsWith("https://kaagzi.in/app/5paisa/welcome")){e.source.close(),k.current=null;try{if(!Object.prototype.hasOwnProperty.call(e.data,"requestToken"))throw new Error("Error reading request token while authenticating");if(null===e.data.requestToken)throw new Error("Error fetching Request token");(async()=>{try{u(!0);if(null==await(async e=>{if(!e||"string"!=typeof e||""===e.toString().trim())return null;try{const t=await b("kaagzi-lambda-5paisa-getAccessToken",{r:e});if(!t)throw new Error;if(!Object.hasOwn(t,"s"))throw new Error;if(0===t.s)throw new Error(t.m);if(1!==t.s)throw new Error;if(!Object.hasOwn(t,"at"))throw new Error;const r={atk:t.at,nm:t.n,id:t.id,t:Date.now()};localStorage.setItem("fivePaisaUser",JSON.stringify(r)),d(t.at),p(t.id),y(t.n)}catch(t){return console.error(t.message||"Error fetching access token from 5paisa"),null}})(e.data.requestToken))throw new Error("Error authenticating with 5paisa");f("Successfully logged into 5paisa","success")}catch(t){f(t.message||"Error while signing into 5paisa","err")}finally{u(!1)}})()}catch(t){f((null==t?void 0:t.message)||"Error while signing into 5paisa","err")}}},A=e=>{if(e.source==window&&(e.origin.startsWith("http://localhost:")||"https://kaagzi.in"===e.origin)&&Object.prototype.hasOwnProperty.call(e.data,"msgFlowDirection")&&"contentScript-to-webPage"===e.data.msgFlowDirection&&Object.prototype.hasOwnProperty.call(e.data,"action")&&"5paisaUserUpdated"===e.data.action)(async()=>{await S()})()};return(0,n.useEffect)((()=>(window.addEventListener("message",x),window.addEventListener("message",A),()=>{window.removeEventListener("message",x),window.removeEventListener("message",A)})),[]),(0,n.useEffect)((()=>{(async()=>{await S()})()}),[w]),n.createElement(n.Fragment,null,null!==m&&null!==h?n.createElement(l.Provider,{value:{id:m,name:g,accessToken:h,checkIfAccessTokenIsAlive:()=>!!v()||(E(),localStorage.removeItem("fivePaisaUser"),!1),chkIf5paisaUserIsLoggedIn:S,logOut:()=>{h&&m&&v()&&fetch("https://Openapi.5paisa.com/VendorsAPI/Service1.svc/Logout",{method:"POST",headers:{Authorization:"Bearer "+h}}).then((e=>e.json())).then((e=>{let{status:t}=e;f("Successfully logged out of 5paisa","success")})).catch((e=>{f("Logged out of 5paisa")})),E(),localStorage.removeItem("fivePaisaUser")}}},t):n.createElement(n.Fragment,null,n.createElement(c.A,{broker:"5paisa",doOnLoginClick:()=>{if(!w)return f("Network unavailable","err"),null;null!==k.current&&(k.current.close(),k.current=null);try{k.current=window.open(`https://dev-openapi.5paisa.com/WebVendorLogin/VLogin/Index?VendorKey=iwwk7jskC0BMxaxnK0VngWo8524hFdKM&ResponseURL=${encodeURIComponent("https://kaagzi.in/app/5paisa/welcome")}`,"5paisa Login","popup=yes,resizable=no,location=no,menubar=no,scrollbars=yes,status=no,titlebar=no,toolbar=no,fullscreen=no,dependent=no,height=640,width=960")}catch(e){console.log(e)}},referralUrlForNewSignupWithBroker:"https://www.5paisa.com/open-demat-account?referralcode=53671410"}),r&&n.createElement(i.A,{note:"Signing into 5paisa"})))}var h=r(117);const d=(0,n.createContext)({isMasterDataReady:!1,masterDataEpochTimestamp:null,getInstrument:async(e,t)=>{},getInstruments:async e=>{},getTokenForInstruments:async e=>{},searchInstruments:async(e,t,r,n,o,a,s)=>{}});function m(e){let{children:t}=e;const{0:r,1:o}=(0,n.useState)(!1),{0:s,1:c}=(0,n.useState)(!1),{0:u,1:m}=(0,n.useState)(null),p=(0,n.useContext)(a.M),{id:g}=(0,n.useContext)(h.R),{id:y,accessToken:f}=(0,n.useContext)(l),w=(0,n.useRef)(null),b=["NSE","BSE","NFO","CDS","MCX"];async function k(){return new Promise(((e,t)=>{var r;if("IDBDatabase"==(null===(r=w.current)||void 0===r?void 0:r.constructor.name)){var n,o,a;if("5paisaMasterData"===(null===(n=w.current)||void 0===n?void 0:n.name))return e(w.current);null===(o=w.current)||void 0===o||null===(a=o.close)||void 0===a||a.call(o)}const s=indexedDB.open("5paisaMasterData",1);s.onupgradeneeded=e=>{w.current=s.result,0===e.oldVersion?[].concat(b,["metaData"]).forEach((e=>{w.current.objectStoreNames.contains(e)||w.current.createObjectStore(e)})):e.oldVersion>0&&e.oldVersion<1&&[].concat(b,["metaData"]).forEach((e=>{w.current.createObjectStore(e)}))},s.onerror=()=>{t(s.error)},s.onsuccess=t=>{w.current=s.result,w.current.onversionchange=()=>{w.current.close(),w.current=null,console.warn("Master database is outdated, please reload the page")},w.current.onclose=()=>{w.current=null},e(w.current)}}))}const E=async(e,t)=>{if(!e)return null;if("string"==typeof e&&""===e.trim())return null;if(!["readonly","readwrite","versionchange"].includes(t))return null;try{const n=await k();if(!n)return null;const o=n.objectStoreNames;if(o.length<1)return null;const a=Array.from(o);if(Array.isArray(e)){for(var r=0;r<e.length;r++)if(!a.includes(e[r]))throw new Error("The "+e[r]+" table does not exist in cache database")}else if("string"==typeof e&&!a.includes(e))throw new Error("The "+e+" table does not exist in cache database");return n.transaction(e,t)}catch(n){return console.error("MASTER-DATA: _withDbTransaction()",n.message||n||"Error initiating transaction"),null}},S=async()=>{const e=await k();return!!e&&new Promise(((t,r)=>{try{const n=e.objectStoreNames;if(n.length<1)return t(!0);const o=Array.from(n),a=e.transaction(o,"readwrite");a.onabort=()=>r(a.error),a.oncomplete=()=>t(!0),o.forEach((e=>{a.objectStore(e).clear()}))}catch(n){r()}}))},v=async()=>{try{if(await(async()=>{try{const e=await E("metaData","readonly"),t=await new Promise(((t,r)=>{const n=e.objectStore("metaData").get("masterData_dl_timestamp");n.onerror=()=>r(n.error),n.onsuccess=()=>t(void 0!==n.result?n.result:null)}));if(!t)return!1;const r=new Date,n=new Date;n.setHours(7,30,0,0);const o=new Date(n);o.setDate(o.getDate()-1);const a=new Date(t);return r>=n?a>=n?Number(t):(S(),!1):a>=o?Number(t):(S(),!1)}catch(e){return!1}})())console.log("MASTER DATA: Already loaded and valid"),c(!0);else{if(r)return!1;console.log("MASTER DATA: Fetching"),await(async()=>{if(r)return!1;try{o(!0);const e=await Promise.all(b.map((async e=>{const t=await fetch(`https://nimworks.github.io/market-data/5paisa/${e}.csv.gz`,{method:"GET",headers:{"Accept-Encoding":"gzip"}});if(!t.ok)throw new Error(`Failed to fetch ${e} data (Status: ${t.status})`);const r=await t.blob(),n=new DecompressionStream("gzip"),o=r.stream().pipeThrough(n),a=(await new Response(o).text()).trim().split("\n");return a.shift(),{xch:e,rows:a}})));if(!e||e.some((e=>!e.rows)))throw new Error("Error fetching 5paisa master data");return await S(),c(!1),new Promise(((t,r)=>{(async()=>{const n=await E([].concat(b,["metaData"]),"readwrite");n.onabort=()=>r(n.error);const a=n.objectStore("NSE"),s=n.objectStore("BSE"),i=n.objectStore("NFO"),l=n.objectStore("CDS"),u=n.objectStore("MCX");e.forEach((e=>{let{xch:t,rows:r}=e;"NSE"===t?r.forEach((e=>{const[t,r]=e.split("/");a.put(r,t)})):"BSE"===t?r.forEach((e=>{const[t,r]=e.split("/");s.put(r,t)})):"NFO"===t?r.forEach((e=>{const[t,r]=e.split("/");i.put(r,t)})):"CDS"===t?r.forEach((e=>{const[t,r]=e.split("/");l.put(r,t)})):"MCX"===t&&r.forEach((e=>{const[t,r]=e.split("/");u.put(r,t)}))}));const h=n.objectStore("metaData"),d=Date.now();h.put(d,"masterData_dl_timestamp"),n.commit(),c(!0),m(d),o(!1),t(new Date(d))})()}))}catch(e){return console.error(e.message),o(!1),!1}})()}return!0}catch(e){return!1}},x=(e,t,r)=>{try{if("NSE"===r||"BSE"===r){const[n,o,a]=t.split(",");if(void 0===a)return null;return""===a.trim()?{token:n,symbol:e,name:e,lotSize:0,exchange:r,isNotTradeable:!0}:{token:n,symbol:e,name:o,lotSize:Number(a),exchange:r}}{const[n,o]=t.split(",");if(void 0===o)return null;const[a,s,i,c]=e.split("|");return void 0===s?{token:n,symbol:e,name:e,lotSize:0,exchange:r,isNotTradeable:!0}:{token:n,symbol:e,name:a,expiry:new Date(i).getTime(),lotSize:Number(o),type:"C"===s?"CE":"P"===s?"PE":"F"===s?"FUT":void 0,strike:"F"===s?void 0:Number(c),exchange:r}}}catch(n){return console.error("MASTER-DATA: _parse_indexedDbKeyVal_to_instrument()",n.message||n||"Error"),null}},A=async(e,t)=>{if(!t||"string"!=typeof t)return null;if(""===t.trim())return null;try{if(!await v())return null;const r=await E(e,"readonly");return r?new Promise(((n,o)=>{const a=r.objectStore(e).get(t);a.onerror=()=>o(a.error),a.onsuccess=()=>{n(void 0!==a.result?x(t,a.result,e):null)}})):null}catch(r){return null}},T=async e=>{if(!e)return null;if("object"!=typeof e)return null;const t=Object.keys(e);if(t.length<1)return null;try{return await v()?new Promise(((r,n)=>{(async()=>{const o=await E(t,"readonly");if(!o)return null;const a=[],s=[];o.onabort=()=>n(o.error),o.oncomplete=()=>r({instrumentsFound:a,instrumentsNotFound:s});await Promise.all(t.map((async t=>{if(!b.includes(t))return!1;const r=o.objectStore(t);await Promise.all(e[t].map((e=>new Promise(((n,i)=>{const c=r.get(e);c.onsuccess=()=>{if(void 0!==c.result){const r=x(e,c.result,t);r?a.push(r):console.warn("MASTER-DATA: getInstruments() Error parsing CSV for "+e)}else s.push({symbol:e,exchange:t});n(!0)},c.onerror=()=>{console.warn("MASTER-DATA: getInstruments() Error while reading data for "+e,o.error),s.push({symbol:e,exchange:t}),n(!0)}})))));return!0})));o.commit()})()})):null}catch(r){return null}};return(0,n.useEffect)((()=>{p&&(g||y)&&(async()=>{await v()})()}),[p,g,y]),n.createElement(d.Provider,{value:{isMasterDataReady:s,masterDataEpochTimestamp:u,getInstrument:A,getInstruments:T,getTokenForInstruments:async e=>{if(!e)return null;if("object"!=typeof e)return null;const t=Object.keys(e);if(t.length<1)return null;try{return await v()?new Promise(((r,n)=>{(async()=>{const o=await E(t,"readonly");if(!o)return null;const a={},s=[];o.onabort=()=>n(o.error),o.oncomplete=()=>r({instrumentsAndTheirToken:a,instrumentsNotFound:s});await Promise.all(t.map((async t=>{if(!b.includes(t))return!1;const r=o.objectStore(t);await Promise.all(e[t].map((e=>new Promise(((n,i)=>{const c=r.get(e);c.onsuccess=()=>{if(void 0!==c.result){const r=x(e,c.result,t);null!==r&&(a[`${r.symbol}:${t}`]=r.token)}else s.push({symbol:e,exchange:t});n(!0)},c.onerror=()=>{console.warn("MASTER-DATA: getTokenForInstruments() Error while reading data for "+e,o.error),s.push({symbol:e,exchange:t}),n(!0)}})))));return!0})));o.commit()})()})):null}catch(r){return null}},searchInstruments:async(e,t,r,n,o,a,s)=>{if(""===t.trim())return null;t=t.toUpperCase(),s&&void 0!==s&&Number.isInteger(Number(s))||(s=20);if(!await v())return null;const i=await E(e,"readonly");if(!i)return null;const c={CE:"C",PE:"P",FUT:"F"};return await new Promise(((l,u)=>{try{const u=i.objectStore(e).openCursor(IDBKeyRange.bound(t,t+"ï¿¿")),h=[];let d=0;u.onsuccess=i=>{const u=i.target.result;if(u&&d<s){if(u.key.startsWith(t))if("NFO"!==e&&"CDS"!==e&&"MCX"!==e||null==r&&null==n&&null==o&&null==a){const t=x(u.key,u.value,e);t&&(h.push(t),d++)}else{let t=!0;if(r&&!u.key.includes(`|${c[r]}|`)&&(t=!1),n&&!u.key.includes(`|${n.toString()}-`)&&(t=!1),o&&!u.key.includes(`-${o<10?"0":""}${o.toString()}-`)&&(t=!1),a&&"FUT"!==r&&!u.key.endsWith(`|${a.toString()}`)&&(t=!1),t){const t=x(u.key,u.value,e);t&&(h.push(t),d++)}}u.continue()}else l(h)},u.onerror=e=>{console.warn("MASTER-DATA: searchInstruments() Cursor Error",i.error),l(null)}}catch(h){console.warn("MASTER-DATA: searchInstruments()",h.message||h||"Error while searching"),l(null)}}))}}},"function"==typeof t?null==t?void 0:t(A,T):t,r&&n.createElement(i.A,{note:"Connecting to market",coverFullPage:!0}))}var p=r(6660);const g=(0,n.createContext)({quotes:{},socketStatus:0,tick:0,subscribeToQuotes:async e=>{},unsubscribeToQuotes:e=>{}});function y(e){let{children:t}=e;const{id:r,accessToken:o,checkIfAccessTokenIsAlive:a}=(0,n.useContext)(l),s=(0,n.useRef)({}),{socketStatus:i,tick:c,sendData:u}=(0,p.A)(`wss://openfeed.5paisa.com/feeds/api/chat?Value1=${o}|${r}`,(async e=>{try{const t=JSON.parse(e);return!!Array.isArray(t)&&(t.forEach((e=>{s.current[String(e.Token)]={ltp:e.LastRate,cp:e.PClose}})),!0)}catch(t){return!1}}),null),h={NSE:{exh:"N",exhTyp:"C"},BSE:{exh:"B",exhTyp:"C"},NFO:{exh:"N",exhTyp:"D"},CDS:{exh:"N",exhTyp:"U"},MCX:{exh:"M",exhTyp:"D"}};return n.createElement(g.Provider,{value:{quotes:s.current,socketStatus:i,tick:c,subscribeToQuotes:async e=>{try{if(!e)return!1;if("Array"!==e.constructor.name)return!1;if(e.length<1)return!1;if(!a())return!1;if((e=e.filter((e=>null!==e.token&&void 0!==e.token&&""!==e.token.trim()))).length<1)return!1;const t={Method:"MarketFeedV3",Operation:"Subscribe",ClientCode:r,MarketFeedData:e.map((e=>{let{token:t,exchange:r}=e;return{Exch:h[r].exh,ExchType:h[r].exhTyp,ScripCode:t}}))};return await u(JSON.stringify(t),!0,!0)}catch(t){return console.error(t),!1}},unsubscribeToQuotes:e=>{if(!e)return!1;if("Array"!==e.constructor.name)return!1;if(e.length<1)return!1;if((e=e.filter((e=>null!==e.token&&void 0!==e.token&&""!==e.token.trim()))).length<1)return!1;try{const t={Method:"MarketFeedV3",Operation:"Unsubscribe",ClientCode:r,MarketFeedData:e.map((e=>{let{token:t,exchange:r}=e;return Object.hasOwn(s.current,t)&&delete s.current[t],{Exch:h[r].exh,ExchType:h[r].exhTyp,ScripCode:t}}))};return u(JSON.stringify(t)),!0}catch(t){return console.error(t),!1}}}},t)}var f=r(5946),w=r(8583),b=r(4506),k=r(7765),E=r(1291),S=r(4398),v=r(9322),x=r(8208),A=r(998),T=r(6278),D=r(6422),C=r(7486);function O(){const{notify:e}=(0,n.useContext)(o._),t=(0,n.useContext)(a.M),{id:r,checkIfPlanActive:s,checkIfLoginSessionIsValid:i}=(0,n.useContext)(h.R),{name:c,logOut:u}=(0,n.useContext)(l),{isMasterDataReady:m,searchInstruments:p}=(0,n.useContext)(d),{socketStatus:y,quotes:f,tick:O,subscribeToQuotes:I,unsubscribeToQuotes:P}=(0,n.useContext)(g),{positionExit:N}=(0,n.useContext)(w.I),{0:F,1:M}=(0,n.useState)([]),{0:j,1:R}=(0,n.useState)([]),{0:L,1:q}=(0,n.useState)(0),{0:B,1:U}=(0,n.useState)(null),{0:$,1:V}=(0,n.useState)(null),{0:z,1:_}=(0,n.useState)(!1),W=(0,n.useCallback)((async e=>{try{if(!Array.isArray(e))throw new Error("Array of instruments expected");return!(e.length<1)&&await I(e.map((e=>{let{token:t,exchange:r}=e;return{token:t,exchange:r}})))}catch(t){return console.error("SCAFFOLD: subscribeToQuotes_mod():",t.message||t),!1}}),[]),Q=(0,n.useCallback)((e=>{try{if(!Array.isArray(e))throw new Error("Array of watchlist instruments expected");return!(e.length<1)&&P(e.map((e=>{let{token:t,exchange:r}=e;return{token:t,exchange:r}})))}catch(t){return console.error("SCAFFOLD: unsubscribeToQuotes_mod():",t.message||t),!1}}),[]),X=(0,C.A)(F,j,B,W,Q,y,m),K=async(r,n)=>{if(!t)return e("Network Unavailable","alert"),!1;try{return r.isNotTradeable?(e(r.symbol+" is not tradeable","alert"),!1):(U(r),!0)}catch(o){return!1}},J=async(e,t,r)=>{try{if(!await i())return!1;await s();const n=await N(e.symbol,e.exchange,t,e.qty,r||!1);return!!n&&(H(n),!0)}catch(n){console.error(n)}},H=e=>{const t=F.find((t=>t.symbol===e.sbl&&t.exchange===e.xh&&t.dir===e.dir));t&&(t.qty===e.qty?M(F.filter((t=>!(t.symbol===e.sbl&&t.exchange===e.xh&&t.dir===e.dir)))):e.qty<t.qty&&M(F.map((t=>(t.symbol===e.sbl&&t.exchange===e.xh&&t.dir===e.dir&&(t.qty=t.qty-e.qty,t.h=Object.hasOwn(t,"h")&&t.h&&Array.isArray(t.h)?[[Date.now(),-1*e.qty,e.cp]].concat((0,b.A)(t.h)):[[Date.now(),-1*e.qty,e.cp]]),t)))))};return(0,n.useEffect)((()=>{if(Object.keys(f).length<1)return;let t=0;F.forEach((r=>{if(!Object.hasOwn(f,r.token))return;const n=f[r.token].ltp;"B"===r.dir?(t+=(n-r.avg)*r.qty,null!==r.sl&&void 0!==r.sl&&n<=r.sl&&(J(r,r.sl,!1),e(`SL hit for ${r.exchange}:${r.symbol} buy trade`,"alert")),null!==r.tp&&void 0!==r.tp&&n>=r.tp&&(J(r,r.tp,!1),e(`TP hit for ${r.exchange}:${r.symbol} buy trade`,"success"))):(t+=(r.avg-n)*r.qty,null!==r.sl&&void 0!==r.sl&&n>=r.sl&&(J(r,r.sl,!0),e(`SL hit for ${r.exchange}:${r.symbol} sell trade`,"alert")),null!==r.tp&&void 0!==r.tp&&n<=r.tp&&(J(r,r.tp,!0),e(`TP hit for ${r.exchange}:${r.symbol} sell trade`,"success")))})),q(t)}),[O,F]),n.createElement(n.Fragment,null,n.createElement(S.j,{broker:"5paisa",brokerLoggedInUserName:c,brokerLogOut:u,doOnWatchListBtnClick:_.bind(this,!0)}),n.createElement(k.A,{currentBroker:"5paisa",currentBrokerCode:"5p",isMasterDataReady:m,socketStatus:y,isSocketRetryWip:X,positionsAry:F,setPositionsAry:M,invokeInstrumentForTransaction:K,instrumentInvokedForTransaction:B,renderNewPosDialog:(e,t)=>B&&n.createElement(A.A,{doNotCloseIfClickedOnBackdrop:!0,doOnClose:U.bind(this,null)},(r=>{var o,a;const{token:s,symbol:i,exchange:c,lotSize:l}=B;return n.createElement(T.A,{instrument:B,ltp:null==f||null===(o=f[s])||void 0===o?void 0:o.ltp,closePrice:null==f||null===(a=f[s])||void 0===a?void 0:a.cp,enterPosition:e,doOnOpeningOrUpdatingPos:()=>{t(),_(!1)},closeDialog:r})})),posInvokedForViewingDetailsOrExiting:$,renderPosMgmtDialog:(e,t)=>n.createElement(A.A,{doOnClose:V.bind(this,null)},(r=>{var o;return n.createElement(D.A,{positionToExit:$,ltp:null==f||null===(o=f[$.token])||void 0===o?void 0:o.ltp,exitPosition:e,addLotsToPosition:t,closeDialog:r})})),totalPnL:L,calcPnlPerExchangeType:()=>{if(Object.keys(f).length<1)return null;let e=0,t=0,r=0,n=0;return F.forEach((o=>{if(!Object.hasOwn(f,o.token))return;const a="B"===o.dir?(f[o.token].ltp-o.avg)*o.qty:(o.avg-f[o.token].ltp)*o.qty;"NSE"===o.exchange||"BSE"===o.exchange?e+=a:"NFO"===o.exchange?t+=a:"MCX"===o.exchange?r+=a:"CDS"===o.exchange&&(n+=a)})),{eq:e,fno:t,com:r,cds:n,total:e+t+r+n}},searchFilterExchangesAry:["NSE","BSE","NFO","CDS","MCX"],searchInstruments:p},F.map(((e,t)=>{var r;const{symbol:o,exchange:a,avg:c,qty:l,dir:u,expiry:h,token:d}=e;return n.createElement(v.A,{wrapperElement:"div",key:`${t}:${d}`,tradingsymbol:o,exchange:a,qty:l,avg:c,ltp:null==f||null===(r=f[d])||void 0===r?void 0:r.ltp,direction:u,onClick:async t=>{await i()&&(await s(),V(e),t.stopPropagation())}})}))),z&&n.createElement(A.A,{doOnClose:()=>{R([]),_(!1)}},n.createElement(E.A,{currentBroker:"5paisa",currentBrokerCode:"5p",isMasterDataReady:m,socketStatus:y,isSocketRetryWip:X,watchlistInstrumentsAry:j,setWatchlistInstrumentsAry:R,searchFilterExchangesAry:["NSE","BSE","NFO","CDS","MCX"],searchInstruments:p},((r,o,a)=>j.map(((s,i)=>{var c,l;const{symbol:u,name:h,token:d,exchange:m,expiry:p,isNotTradeable:g}=s,y=o&&o.token===d;return n.createElement(x.A,{wrapperElement:"div",key:d,onClick:a.bind(this,y?{}:s),isExpandedView:y,tradingsymbol:u,entityName:h,exchange:m,ltp:null==f||null===(c=f[d])||void 0===c?void 0:c.ltp,closePrice:null==f||null===(l=f[d])||void 0===l?void 0:l.cp,expiry:p,closeExpandedView:a.bind(this,{}),isNotTradeable:g,onBuyClick:()=>{var r;t?null!=f&&null!==(r=f[d])&&void 0!==r&&r.ltp?(async()=>{await K(s)})():e("Error inferring price for "+u,"err"):e("Network unavailable","err")},onRemoveClick:()=>{r(u,m,d).then((()=>{a({})}))}})}))))))}function I(){return n.createElement(u,null,n.createElement(m,null,((e,t)=>n.createElement(f.A,null,n.createElement(w.A,{currentBrokerCode:"5p",masterData_getInstrument:e,masterData_getInstruments:t},n.createElement(y,null,n.createElement(O,null)))))))}},3067:function(e,t,r){r.r(t),r.d(t,{Head:function(){return c},default:function(){return i}});var n=r(6540),o=r(4140),a=r(268),s=r(8719);function i(){return n.createElement(o.A,null,n.createElement(a.A,null,(()=>{const e=r(2164).A;return n.createElement(e,null)})))}function c(){return n.createElement(s.y,{title:"5paisa"})}}}]);