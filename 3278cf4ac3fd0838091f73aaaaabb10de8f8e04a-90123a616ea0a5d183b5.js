"use strict";(self.webpackChunkkaagzi=self.webpackChunkkaagzi||[]).push([[477],{9611:function(e,t,r){r.d(t,{A:function(){return i}});var a=r(6540),n=r(214),o="coloredNumberDisplay-module--isGreen--7185e",l="coloredNumberDisplay-module--isRed--bc675";function i(e){let{currentVal:t,baseVal:r,additionalClassWhenGreen:i,additionalClassWhenRed:c,className:s}=e;const u=null!==t&&null!==r?Number(t)>=Number(r)?`${o}${i?" "+i:""}`:`${l}${c?" "+c:""}`:"";return a.createElement("span",{className:`${u}${s?" "+s:""}`},null!==t?(0,n.kH)(Number(t)):"-.--")}},7104:function(e,t,r){r.d(t,{A:function(){return u}});var a=r(6540),n="symbolName-module--isBuy--0343f",o="symbolName-module--isSell--096f6",l="symbolName-module--sblNmEq--6ace5",i="symbolName-module--sblNmNfoCe--54bc6",c="symbolName-module--sblNmNfoFut--87fa9",s="symbolName-module--sblNmNfoPe--8551e";function u(e){let{tradingsymbol:t,exchange:r,isPositionSymbol:u,isSellTrade:m,className:d}=e;const w=" "+`${u?m?o:n:""}${d?" "+d:""}`.trim();if("NFO"!==r&&"CDS"!==r&&"MCX"!==r)return a.createElement("span",{className:`${l}${w}`,"data-exchange":r},t);{const e=t.split("|");if(e.length<2)return a.createElement("span",{className:`${l}${w}`,"data-exchange":r},t);const n=new Date(e[2]).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"2-digit"}).replace(",","").replace(/\d{2}$/,"'$&");if("C"===e[1])return a.createElement("span",{className:`${i}${w}`,"data-exchange":r},e[0],a.createElement("span",{"data-expiry":n},e[3]));if("P"===e[1])return a.createElement("span",{className:`${s}${w}`,"data-exchange":r},e[0],a.createElement("span",{"data-expiry":n},e[3]));if("F"===e[1])return a.createElement("span",{className:`${c}${w}`,"data-exchange":r},e[0],a.createElement("span",{"data-expiry":n}))}return a.createElement("span",null,"---")}},2488:function(e,t,r){r.d(t,{A:function(){return u}});var a=r(6540),n=r(1298),o=r(117),l=r(5946),i=r(2059),c=r(3654),s="walletDepositInput-module--quickSuggestionC--b584e";function u(e){let{doOnDeposit:t,showVirtualAmtNotice:r=!1,className:u}=e;const{notify:m}=(0,a.useContext)(n._),{checkIfPlanActive:d}=(0,a.useContext)(o.R),{depositToWallet:w}=(0,a.useContext)(l.s),{0:E,1:h}=(0,a.useState)("");return a.createElement("div",{className:u&&""!==(null==u?void 0:u.trim())?u:null},a.createElement(i.Ay,{type:"number",name:"Deposit-amount",icon:"rupee-sign",placeholder:"Deposit virtual amount",value:E,onChange:e=>{h(e.target.value)},actionPane:a.createElement(c.Ay,{variant:"primary",isDark:!0,onClick:()=>{(async()=>{await(async e=>{if(!e||"number"!=typeof e)return m("Kindly input a valid deposit amount","alert"),null;if(e<=0)return m("Deposit amount should be greater than 0","alert"),null;try{if(!await d())throw new Error("Plan Expired!");const r=await w(e);if(!r)throw new Error;return null==t||t(r),m(`Successfully deposited ${e.toLocaleString("en-IN",{style:"currency",currency:"INR"})} in wallet`,"success"),r}catch(r){return console.error(r.message||r||"Error depositing to wallet"),m(r.message||r||"Error depositing to wallet","err"),null}})(Number(E))&&h("")})()}},"Deposit")}),a.createElement("div",{className:s},a.createElement("button",{onClick:h.bind(null,"10000")},"10,000/-"),a.createElement("button",{onClick:h.bind(null,"100000")},"1,00,000/-"),a.createElement("button",{onClick:h.bind(null,"1000000")},"10,00,000/-")),r&&a.createElement("p",null,"This is just virtual amount and not real currency. You can choose to deposit any arbitrary virtual amount of your choice which shall be used to enter trade positions. This transaction is strictly virtual & shall not reflect in your actual bank-account transactions."))}},4488:function(e,t,r){r.d(t,{A:function(){return i}});var a=r(6540),n=r(1298),o=r(117),l=r(5946);function i(){const{notify:e}=(0,a.useContext)(n._),{id:t,checkIfPlanActive:r}=(0,a.useContext)(o.R),i=(0,a.useRef)(t),{getWalletData:c}=(0,a.useContext)(l.s),{0:s,1:u}=(0,a.useState)(0),m=(0,a.useRef)(0),{0:d,1:w}=(0,a.useState)(0),E=(0,a.useRef)(0),{0:h,1:y}=(0,a.useState)(0),p=(0,a.useRef)(0),{0:b,1:g}=(0,a.useState)(0),f=(0,a.useRef)(0),{0:v,1:D}=(0,a.useState)({eq:0,fno:0,com:0,cd:0}),N=(0,a.useRef)({eq:0,fno:0,com:0,cd:0}),P=async()=>{try{if(!await r())throw new Error("Plan Expired!");const e=await c(!1,!0);if(!e)throw new Error;return u(e.balance),w(e.cumulativeDeposit),y(e.cumulativeWithdrawal),g((null==e?void 0:e.amtInvestedInPositions)||0),D((null==e?void 0:e.cumulativeBookedPnL)||{eq:0,fno:0,com:0,cd:0}),e}catch(t){return console.error(t.message||t||"Error reading wallet data"),e(t.message||t||"Error reading wallet data","err"),null}};return(0,a.useEffect)((()=>{i.current=t,(async()=>{await P()})()}),[t]),(0,a.useEffect)((()=>{m.current=s,E.current=d,p.current=h,f.current=b,N.current=v}),[s,d,h,b,v]),{walletBalance:s,cumulativeDeposit:d,cumulativeWithdrawal:h,amtInvestedInPositions:b,cumulativeBookedPnL:v,reFetch:P}}},5946:function(e,t,r){r.d(t,{A:function(){return c},s:function(){return i}});var a=r(4506),n=r(6540),o=r(117),l=r(214);const i=(0,n.createContext)({getPosition:async(e,t,r,a)=>{},setPosition:async(e,t,r,a,n,o,l)=>{},exitPosition:async(e,t,r,a,n,o)=>{},getWalletData:async function(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1)},depositToWallet:async e=>{},withdrawFromWallet:async e=>{},getWalletTransactionsHistory:async(e,t,r)=>{},clearEntireWalletTransactionsHistory:async()=>{},getCumulativeBookedPnL:async()=>{},getWatchlistInstruments:async e=>{},setWatchlistInstrument:async(e,t,r,a,n)=>{},setWatchlistMultipleInstruments:async(e,t)=>{},deleteWatchlistInstrument:async(e,t,r)=>{},clearWatchlist:async e=>{},getTradeHistory:async(e,t,r)=>{},clearEntireTradeHistory:async()=>{}});function c(e){let{children:t}=e;const{id:r}=(0,n.useContext)(o.R),c=(0,n.useRef)(null),s={"watchlist-1":"10","watchlist-2":"10","watchlist-3":"10","watchlist-4":"10","watchlist-5":"10","watchlist-6":"10",positions:"20"};async function u(){return new Promise(((e,t)=>{var a;r&&"string"==typeof r&&""!==r.trim()||t();const n="Kaagzi_"+r;if("IDBDatabase"==(null===(a=c.current)||void 0===a?void 0:a.constructor.name)){var o,l,i;if((null===(o=c.current)||void 0===o?void 0:o.name)===n)return e(c.current);null===(l=c.current)||void 0===l||null===(i=l.close)||void 0===i||i.call(l)}const s=indexedDB.open(n,1);s.onupgradeneeded=e=>{if(c.current=s.result,0===e.oldVersion){if(c.current.objectStoreNames.contains("app-data")||c.current.createObjectStore("app-data"),c.current.objectStoreNames.contains("watchlist-1")||c.current.createObjectStore("watchlist-1"),c.current.objectStoreNames.contains("watchlist-2")||c.current.createObjectStore("watchlist-2"),c.current.objectStoreNames.contains("watchlist-3")||c.current.createObjectStore("watchlist-3"),c.current.objectStoreNames.contains("watchlist-4")||c.current.createObjectStore("watchlist-4"),c.current.objectStoreNames.contains("watchlist-5")||c.current.createObjectStore("watchlist-5"),c.current.objectStoreNames.contains("watchlist-6")||c.current.createObjectStore("watchlist-6"),c.current.objectStoreNames.contains("positions")||c.current.createObjectStore("positions"),!c.current.objectStoreNames.contains("trade-history")){c.current.createObjectStore("trade-history",{keyPath:"ID",autoIncrement:!0}).createIndex("type","typ",{unique:!1})}if(!c.current.objectStoreNames.contains("wallet-history")){c.current.createObjectStore("wallet-history",{keyPath:"ID",autoIncrement:!0}).createIndex("type","typ",{unique:!1})}}else if(e.oldVersion>0&&e.oldVersion<1){c.current.createObjectStore("app-data"),c.current.createObjectStore("watchlist-1"),c.current.createObjectStore("watchlist-2"),c.current.createObjectStore("watchlist-3"),c.current.createObjectStore("watchlist-4"),c.current.createObjectStore("watchlist-5"),c.current.createObjectStore("watchlist-6"),c.current.createObjectStore("positions");c.current.createObjectStore("trade-history",{keyPath:"ID",autoIncrement:!0}).createIndex("type","typ",{unique:!1});c.current.createObjectStore("wallet-history",{keyPath:"ID",autoIncrement:!0}).createIndex("type","typ",{unique:!1})}},s.onerror=()=>{t(s.error)},s.onsuccess=t=>{c.current=s.result,c.current.onversionchange=()=>{c.current.close(),c.current=null,console.warn("Database is outdated, please reload the page")},c.current.onclose=()=>{c.current=null},e(c.current)}}))}const m=async(e,t)=>{if(!e)return null;if("string"==typeof e&&""===e.trim())return null;if(!["readonly","readwrite","versionchange"].includes(t))return null;try{const a=await u();if(!a)return null;const n=a.objectStoreNames;if(n.length<1)return null;const o=Array.from(n);if(Array.isArray(e)){for(var r=0;r<e.length;r++)if(!o.includes(e[r]))throw new Error("The "+e[r]+" table does not exist in database")}else if("string"==typeof e&&!o.includes(e))throw new Error("The "+e+" table does not exist in database");return a.transaction(e,t)}catch(a){return console.error("APP-DB-PROVIDER: initTransaction()",a.message||a||"Error initiating transaction"),null}},d=async e=>{if("IDBObjectStore"!==(null==e?void 0:e.constructor.name))return!1;if(!Object.hasOwn(s,e.name))return!0;const t=s[e.name],r=await new Promise(((t,r)=>{const a=e.count();a.onsuccess=()=>{t(a.result)},a.onerror=()=>{r(null)}}));if(null==r)throw new Error("Error reading stored item count");const a=t-r;return!(a<=0)&&a},w=async(e,t,r)=>e&&"IDBTransaction"===(null==e?void 0:e.constructor.name)?!t||"IDBObjectStore"!==(null==t?void 0:t.constructor.name)&&"IDBIndex"!==(null==t?void 0:t.constructor.name)?null:new Promise(((a,n)=>{let o;o=r?t.get(r):t.getAll(),o.onerror=t=>{n(o.error),e.abort()},o.onsuccess=()=>{a(void 0!==o.result?o.result:r?null:[])}})):null,E=async(e,t,r,a,n)=>{if(!e||"IDBTransaction"!==(null==e?void 0:e.constructor.name))return null;if(!t||"IDBObjectStore"!==(null==t?void 0:t.constructor.name)&&"IDBIndex"!==(null==t?void 0:t.constructor.name))return null;isNaN(Number(r))&&(r=0),a&&!isNaN(Number(a))||(a=20);const o=r*a;try{if("IDBIndex"===(null==t?void 0:t.constructor.name)&&(null==n||null==n))throw new Error("When retrieving via index, index value to filter for is required");const[r,l]=await Promise.all([new Promise(((e,r)=>{const l=t.openCursor("IDBIndex"===(null==t?void 0:t.constructor.name)&&null!=n&&null!=n?IDBKeyRange.only(n):null,"prev"),i=[];let c=!1;l.onsuccess=t=>{const r=t.target.result;r?!c&&o>0?(r.advance(o),c=!0):(i.push(r.value),i.length<a?r.continue():e(i)):e(i)},l.onerror=e=>r(e)})),new Promise(((e,r)=>{const a=t.count("IDBIndex"===(null==t?void 0:t.constructor.name)&&null!=n&&null!=n?IDBKeyRange.only(n):null);a.onsuccess=()=>{e(a.result)},a.onerror=()=>r("Error counting records")}))]).catch((t=>{throw e.abort(),new Error(t.message||t||"Error")}));return r&&Array.isArray(r)?r.length<1?{records:[],totalRecords:0,totalPages:0}:{records:r,totalRecords:l,totalPages:Math.ceil(l/a)}:null}catch(l){return console.error("APP-DB-PROVIDER: getPaginatedRecords()",l.message||l||"Error"),null}},h=async(e,t,r,a)=>null==r||null==r?null:e&&"IDBTransaction"===(null==e?void 0:e.constructor.name)&&t&&"IDBObjectStore"===(null==t?void 0:t.constructor.name)?new Promise(((n,o)=>{(async()=>{try{if(!t.autoIncrement&&!t.keyPath&&!a)throw new Error("PK required by table");let l;if(Array.isArray(r)){if(null==r||!r.length)throw new Error("List of items to save to DB is empty");if(!t.autoIncrement&&!t.keyPath)throw new Error("When writing list of items, table should either have autoIncrement or keyPath specified");const a=await d(t);if(!a||a<r.length)return o("Space unavailable"),void e.abort();for(let e=0;e<r.length;e++)l=t.put(r[e])}else l=t.autoIncrement||t.keyPath?t.put(r):t.put(r,a);l.onerror=t=>{o(t.target.error),e.abort()},l.onsuccess=e=>{n(e.target.result)}}catch(l){console.error("APP-DB-PROVIDER: set()",l.message||l||"Error"),e.abort(),n(null)}})()})):null,y=async(e,t,r)=>e&&"IDBTransaction"===(null==e?void 0:e.constructor.name)&&t&&"IDBObjectStore"===(null==t?void 0:t.constructor.name)?new Promise(((a,n)=>{try{let o;o=r&&"string"==typeof r&&""!==r.trim()?t.delete(r):t.clear(),o.onerror=t=>{n(t.target.error),e.abort()},o.onsuccess=()=>a(!0)}catch(o){console.error("APP-DB-PROVIDER: delete()",o.message||o||"Error"),e.abort(),a(!1)}})):null,p=async(e,t,r,a)=>{try{const n=a&&"IDBTransaction"===(null==a?void 0:a.constructor.name)?a:await m("positions","readwrite");if(!n)throw new Error("Error getting DB transaction handle");if(null!=e&&null!=t){const a=await w(n,n.objectStore("positions"),`${e}:${t}:${r?"S":"B"}`);return a?a.x&&2===(0,l.RP)(new Date(a.x))?(await b(a),null):a:null}const o=await w(n,n.objectStore("positions"),null);if(!o||!Array.isArray(o))return null;if(o.length<1)return[];const i=o.map((e=>null!=e&&e.x&&e.x<=Date.now()?((async()=>{await b(e)})(),!1):e)).filter((e=>!1!==e));return a||n.commit(),i}catch(n){return console.error("APP-DB: getPosition()",n.message||n||"Error"),null}},b=async e=>new Promise(((t,r)=>{(async()=>{try{if(!e)throw new Error("Expired position not specified");const a=await m(["app-data","positions","trade-history","wallet-history"],"readwrite");if(!a)throw new Error("Error getting DB transaction handle");a.onabort=()=>r((null==a?void 0:a.error)||"DB-transaction aborted"),a.onerror=()=>r((null==a?void 0:a.error)||"DB-transaction ERROR");const n={typ:1,sbl:e.sbl,xh:e.xh,avg:(0,l.Wf)(e.avg),cp:0,qty:e.qty,t:e.t,x:e.x,dir:e.dir,bkr:e.bkr};e.sl&&(n.sl=e.sl),e.tp&&(n.tp=e.tp);if(!await h(a,a.objectStore("trade-history"),n,null))throw new Error("Error writing position-exit record to trade-history DB");if(!await y(a,a.objectStore("positions"),`${e.sbl}:${e.xh}:${e.dir}`))throw new Error("Error deleting expired position");await D(e.xh,(0-e.avg)*e.qty),t(n)}catch(a){console.error("APP-DB: _exitExpiredPosition():",a.message||a||"Error"),t(null)}})()})),g=async function(e,t){return void 0===t&&(t=null),!e||isNaN(Number(e))||"number"!=typeof e||e<=0?null:new Promise(((r,a)=>{(async()=>{try{const a=await m(["app-data","wallet-history"],"readwrite");if(!a)throw new Error("Error getting DB transaction handle");const n=a.objectStore("app-data"),o=await w(a,n,"wallet-data")||{balance:0,cumulativeDeposit:0,cumulativeWithdrawal:0},l=t?{...o,balance:Number((Number(o.balance)+e).toFixed(2))}:{balance:Number((Number(o.balance)+e).toFixed(2)),cumulativeDeposit:Number((Number(o.cumulativeDeposit)+e).toFixed(2)),cumulativeWithdrawal:o.cumulativeWithdrawal};if(!await h(a,n,l,"wallet-data"))throw"";const i={typ:t?1:2,amt:e,t:Date.now()};if(t&&(i.thPK=t),!await h(a,a.objectStore("wallet-history"),i,null))throw"";r(l)}catch(a){console.error("APP-DB: _creditToWallet():",a.message||a||"Error"),r(null)}})()}))},f=async function(e,t){return void 0===t&&(t=null),!e||isNaN(Number(e))||"number"!=typeof e||e<=0?null:new Promise(((r,a)=>{(async()=>{try{const n=await m(["app-data","wallet-history"],"readwrite");if(!n)throw new Error("Error getting DB transaction handle");const o=n.objectStore("app-data"),l=await w(n,o,"wallet-data")||{balance:0,cumulativeDeposit:0,cumulativeWithdrawal:0};if(e>l.balance)return a("Insufficient wallet balance"),n.abort(),null;const i=t?{...l,balance:Number((Number(l.balance)-e).toFixed(2))}:{balance:Number((Number(l.balance)-e).toFixed(2)),cumulativeDeposit:l.cumulativeDeposit,cumulativeWithdrawal:Number((Number(l.cumulativeWithdrawal)+e).toFixed(2))};if(!await h(n,o,i,"wallet-data"))throw"";const c={typ:t?0:3,amt:e,t:Date.now()};if(t&&(c.thPK=t),!await h(n,n.objectStore("wallet-history"),c,null))throw"";r(i)}catch(n){console.error("APP-DB: _debitFromWallet():",n.message||n||"Error"),r(null)}})()}))},v=async()=>new Promise(((e,t)=>{(async()=>{try{const r=await m("app-data","readonly");if(!r)throw new Error("Error initiating DB transaction");r.onabort=()=>t(r.error||"Cumulative PnL read DB-transaction aborted"),r.onerror=()=>t(r.error||"Cumulative PnL read DB-transaction ERROR");const a=await w(r,r.objectStore("app-data"),"cumulative-booked-pnl");e({eq:(null==a?void 0:a.eq)||0,fno:(null==a?void 0:a.fno)||0,com:(null==a?void 0:a.com)||0,cd:(null==a?void 0:a.cd)||0})}catch(r){console.error("APP-DB: getCumulativeBookedPnL():",r.message||r),e(null)}})()})),D=async(e,t)=>new Promise(((r,a)=>{(async()=>{try{const n=await m("app-data","readwrite");if(!n)throw new Error("Error initiating DB transaction");n.onabort=()=>a(n.error||"Cumulative PnL read DB-transaction aborted"),n.onerror=()=>a(n.error||"Cumulative PnL read DB-transaction ERROR");const o=n.objectStore("app-data"),l=await w(n,o,"cumulative-booked-pnl")||{};"NSE"===e||"BSE"===e?l.eq=Number((((null==l?void 0:l.eq)||0)+t).toFixed(2)):"NFO"===e?l.fno=Number((((null==l?void 0:l.fno)||0)+t).toFixed(2)):"MCX"===e?l.com=Number((((null==l?void 0:l.com)||0)+t).toFixed(2)):"CDS"===e&&(l.cd=Number((((null==l?void 0:l.cd)||0)+t).toFixed(2)));if(!await h(n,o,l,"cumulative-booked-pnl"))throw new Error("Error updating cumulative booked PnL");r({eq:(null==l?void 0:l.eq)||0,fno:(null==l?void 0:l.fno)||0,com:(null==l?void 0:l.com)||0,cd:(null==l?void 0:l.cd)||0})}catch(n){console.error("APP-DB: _updateCumulativeBookedPnL():",n.message||n),r(null)}})()}));return n.createElement(i.Provider,{value:{getPosition:p,setPosition:async(e,t,r,n,o,i,c)=>new Promise(((s,u)=>{(async()=>{try{if(!(e&&t&&r&&n&&o))throw new Error("One of required pos data not specified");const d={sbl:e,xh:t,avg:r,qty:n,t:Date.now(),dir:"B"===i?"B":"S",bkr:o};void 0!==c&&(2===(0,l.RP)(new Date(c))&&u("Instrument expired"),d.x=c);const E=await m(["app-data","positions","trade-history","wallet-history"],"readwrite");if(!E)throw new Error("Error initiating DB transaction");E.onabort=()=>u(E.error||"DB-transaction aborted"),E.onerror=()=>u(E.error||"DB-transaction ERROR");const y=r*n,b=E.objectStore("app-data"),g=await w(E,b,"wallet-data");if(null==g||g.balance<y)return u("Insufficient wallet balance"),void E.abort();const v=await p(e,t,"S"===d.dir,E),D=Date.now();let N=null;if(v){N={...d};const e=v.avg*v.qty+y,t=v.qty+d.qty;N.qty=t,N.avg=(0,l.Wf)(e/t),N.t=D,N.h=Object.hasOwn(v,"h")&&v.h&&Array.isArray(v.h)?[[d.t,d.qty,r]].concat((0,a.A)(v.h)):[[d.t,d.qty,r]]}else d.h=[[d.t,d.qty,r]];if(!await h(E,E.objectStore("positions"),N||d,`${e}:${t}:${d.dir}`).catch((e=>{e.message&&"Space unavailable"===e.message&&u("Space unavailable")})))throw new Error("Error writing position to DB");const P={typ:0,sbl:d.sbl,xh:d.xh,avg:(0,l.Wf)(d.avg),qty:d.qty,t:D,dir:d.dir,bkr:d.bkr};null!=d&&d.sl&&(P.sl=(0,l.Wf)(d.sl)),null!=d&&d.tp&&(P.tp=(0,l.Wf)(d.tp));const S=await h(E,E.objectStore("trade-history"),P,null);if(!S)throw new Error("Error writing position-entry record to trade-history DB");if(!await f(y,S).catch((e=>{if("Insufficient wallet balance"===e)return E.abort(),u(e),null})))throw E.abort(),new Error("Error updating wallet balance");s(N||d)}catch(d){console.error("APP-DB-PROVIDER: setPosition():",d.message||d||"Error"),s(null)}})()})),exitPosition:async(e,t,r,n,o,i)=>e&&"string"==typeof e&&""!==e.trim()?new Promise(((c,s)=>{(async()=>{try{const u=await p(e,t,r,null);if(!u)throw new Error(e+" position does not exist");let d=Date.now();Object.hasOwn(u,"x")&&u.x<Date.now()&&(d=u.x),(!o||o>u.qty)&&(o=u.qty);const w={typ:1,sbl:u.sbl,xh:u.xh,avg:(0,l.Wf)(u.avg),cp:(0,l.Wf)(n),qty:o,t:u.t,x:d,dir:u.dir,bkr:i||u.bkr};u.sl&&(w.sl=u.sl),u.tp&&(w.tp=u.tp);const E=await m(["app-data","positions","trade-history","wallet-history"],"readwrite");if(!E)throw new Error("Error getting DB transaction handle");E.onabort=()=>s((null==E?void 0:E.error)||"DB-transaction aborted"),E.onerror=()=>s((null==E?void 0:E.error)||"DB-transaction ERROR");const b=await h(E,E.objectStore("trade-history"),w,null);if(!b)throw new Error("Error writing position-exit record to trade-history DB");if(o===u.qty){if(!await y(E,E.objectStore("positions"),`${e}:${t}:${r?"S":"B"}`))throw new Error("Error deleting position")}else{const e={...u};e.qty=u.qty-o,e.h=Object.hasOwn(u,"h")&&u.h&&Array.isArray(u.h)?[[d,-1*o,n]].concat((0,a.A)(u.h)):[[d,-1*o,n]];if(!await h(E,E.objectStore("positions"),e,`${e.sbl}:${e.xh}:${e.dir}`))throw new Error("Error updating position during partial exit")}if(!await g(n*o,b))throw new Error("Error crediting amount to wallet");n!==u.avg&&await D(t,(n-u.avg)*o),c(w)}catch(u){console.error("APP-DB: exitPosition():",u.message||u||"Error"),c(null)}})()})):null,getWalletData:async function(e,t){return void 0===e&&(e=!1),void 0===t&&(t=!1),new Promise(((r,a)=>{(async()=>{try{const n=await m(e?"app-data":["app-data","positions"],"readonly");if(!n)throw new Error("Error initiating DB transaction");n.onabort=()=>a(n.error||"Wallet data read DB-transaction aborted"),n.onerror=()=>a(n.error||"Wallet data read DB-transaction ERROR");const o=await w(n,n.objectStore("app-data"),"wallet-data");if(!o)return r({balance:0,cumulativeDeposit:0,cumulativeWithdrawal:0});if(!e){const e=await async function(e){void 0===e&&(e=null);try{var t;const r=e&&"IDBTransaction"===(null===(t=e)||void 0===t?void 0:t.constructor.name)?e:await m("positions","readonly");if(!r)throw new Error("Error getting DB transaction handle");const a=await w(r,r.objectStore("positions"),null);if(!a||!Array.isArray(a))return null;if(a.length<1)return 0;let n=0;return a.forEach((e=>{n+=e.avg*e.qty})),e||r.commit(),n}catch(r){return console.error("APP-DB: _getAmountInvestedInPositions()",r.message||r||"Error"),null}}(n);o.amtInvestedInPositions=e||0}if(t){const e=await v();null!==e&&(o.cumulativeBookedPnL=e)}r(o)}catch(n){console.error("APP-DB: getWalletData():",n.message||n),r(null)}})()}))},depositToWallet:async e=>{try{const t=await g(e,null);if(!t)throw new Error("Error crediting deposit amount to wallet");return t}catch(t){return console.error("APP-DB: depositToWallet():",t.message||t||"Error"),null}},withdrawFromWallet:async e=>{try{const t=await f(e,null);if(!t)throw new Error("Error crediting deposit amount to wallet");return t}catch(t){if("string"==typeof t&&"Insufficient wallet balance"===t)throw t;return console.error("APP-DB: withdrawFromWallet():",t.message||t||"Error"),null}},getWalletTransactionsHistory:async(e,t,r)=>{(void 0===e||isNaN(Number(e)))&&(e=1);const a="DEBIT"===r?0:"CREDIT"===r?1:"DEPOSIT"===r?2:"WITHDRAW"===r?3:null;return new Promise(((r,n)=>{(async()=>{try{const o=await m("wallet-history","readonly");if(!o)throw new Error("Error initiating DB transaction");o.onabort=()=>n(o.error||"DB-transaction aborted"),o.onerror=()=>n(o.error||"DB-transaction ERROR");const l=await E(o,null!==a?o.objectStore("wallet-history").index("type"):o.objectStore("wallet-history"),e-1,t||20,a);r(l)}catch(o){console.error("APP-DB-PROVIDER: getWalletTransactionsHistory():",o.message||o||"Error"),r(null)}})()}))},clearEntireWalletTransactionsHistory:async()=>new Promise(((e,t)=>{(async()=>{try{const r=await m("wallet-history","readwrite");if(!r)throw new Error("Error initiating DB transaction");r.onabort=()=>t(r.error||"DB-transaction aborted"),r.onerror=()=>t(r.error||"DB-transaction ERROR");if(!await y(r,r.objectStore("wallet-history"),null))throw new Error("Error clearing wallet transactions");e(!0)}catch(r){console.error("APP-DB-PROVIDER: clearEntireWalletTransactionsHistory():",r.message||r||"Error"),e(!1)}})()})),getCumulativeBookedPnL:v,getWatchlistInstruments:async e=>((!e||!Number.isInteger(e)||e<1||e>6)&&(e=1),new Promise(((t,r)=>{(async()=>{try{const a=await m("watchlist-"+e,"readwrite");if(!a)throw new Error("Error initiating DB transaction");a.onabort=()=>r(a.error||"DB-transaction aborted"),a.onerror=()=>r(a.error||"DB-transaction ERROR");const n=await w(a,a.objectStore("watchlist-"+e),null);if(!n||!Array.isArray(n))return t(null);if((null==n?void 0:n.length)<1)return t([]);const o=n.map((t=>{const r=t.split(",");return""!==r[2]&&2==(0,l.RP)(new Date(Number(r[2])))?((async()=>{await y(a,a.objectStore("watchlist-"+e),`${r[0]}:${r[1]}`)})(),!1):{sbl:r[0],xh:r[1],x:""===r[2]?null:r[2],bkr:r[3]}})).filter((e=>!1!==e));t(o)}catch(a){console.error("APP-DB-PROVIDER: getWatchlistInstruments():",a.message||a||"Error"),t(null)}})()}))),setWatchlistInstrument:async(e,t,r,a,n)=>{if((!e||!Number.isInteger(e)||e<1||e>6)&&(e=1),!t||"string"!=typeof t||""===t.trim())return null;if(!r||"string"!=typeof r||""===r.trim())return null;if(a&&Number.isInteger(a)||(a=""),!n)throw new Error("Broker code not specified");return new Promise(((o,l)=>{(async()=>{try{const i=await m("watchlist-"+e,"readwrite");if(!i)throw new Error("Error initiating DB transaction");i.onabort=()=>l(i.error||"DB-transaction aborted"),i.onerror=()=>l(i.error||"DB-transaction ERROR");const c=await h(i,i.objectStore("watchlist-"+e),`${t},${r},${a},${n}`,`${t}:${r}`).catch((e=>{e&&e.message&&"Space unavailable"===e.message&&l(e.message)}));if(!c)throw new Error("Error storing watchlist instrument");o(c)}catch(i){console.error("APP-DB-PROVIDER: setWatchlistInstrument():",i.message||i||"Error"),o(null)}})()}))},setWatchlistMultipleInstruments:async(e,t)=>((!e||!Number.isInteger(e)||e<1||e>6)&&(e=1),!(!t||!Array.isArray(t)||t.length<1)&&new Promise(((r,a)=>{(async()=>{try{const n=await m("watchlist-"+e,"readwrite");if(!n)throw new Error("Error initiating DB transaction");n.onabort=()=>a(n.error||"DB-transaction aborted"),n.onerror=()=>a(n.error||"DB-transaction ERROR");const o=t.reduce(((e,t)=>(t.sbl&&t.xh&&t.bkr&&(e[`${t.sbl}:${t.xh}`]=`${t.sbl},${t.xh},${Object.hasOwn(t,"x")&&t.x&&Number.isInteger(t.x)?t.x:""},${t.bkr}`),e)),{});if(Object.keys(o).length<1)throw new Error("Symbol, exchange and broker data required for every watchlist instrument");const l=await(async(e,t,r)=>{if(!e||"IDBTransaction"!==(null==e?void 0:e.constructor.name))return null;if(!t||"IDBObjectStore"!==(null==t?void 0:t.constructor.name))return null;const a=Object.keys(r);if(a.length<1)return!1;const n=await d(t);if(!n)throw new Error("Space unavailable");if(Number.isInteger(n)&&a.length>n)throw new Error("Space inadequate");return!(await Promise.all(a.map((e=>new Promise((a=>{const n=t.put(r[e],e);n.onerror=t=>{console.error("Error storing item with PK:",e,t.target.error),a(!1)},n.onsuccess=()=>a(!0)})))))).includes(!1)||(e.abort(),!1)})(n,n.objectStore("watchlist-"+e),o).catch((e=>{e&&e.message&&"Space unavailable"===e.message&&a(e.message)}));if(!l)throw new Error("Error storing watchlist instruments");r(!0)}catch(n){console.error("APP-DB-PROVIDER: setWatchlistMultipleInstruments():",n.message||n||"Error"),r(!1)}})()}))),deleteWatchlistInstrument:async(e,t,r)=>((!e||!Number.isInteger(e)||e<1||e>6)&&(e=1),!(!t||"string"!=typeof t||""===t.trim())&&(!(!r||"string"!=typeof r||""===r.trim())&&new Promise(((a,n)=>{(async()=>{try{const o=await m("watchlist-"+e,"readwrite");if(!o)throw new Error("Error initiating DB transaction");o.onabort=()=>n(o.error||"DB-transaction aborted"),o.onerror=()=>n(o.error||"DB-transaction ERROR");if(!await y(o,o.objectStore("watchlist-"+e),`${t}:${r}`))throw new Error("Error deleting watchlist instrument");a(!0)}catch(o){console.error("APP-DB-PROVIDER: deleteWatchlistInstrument():",o.message||o||"Error"),a(!1)}})()})))),clearWatchlist:async e=>((!e||!Number.isInteger(e)||e<1||e>6)&&(e=1),new Promise(((t,r)=>{(async()=>{try{const a=await m("watchlist-"+e,"readwrite");if(!a)throw new Error("Error initiating DB transaction");a.onabort=()=>r(a.error||"DB-transaction aborted"),a.onerror=()=>r(a.error||"DB-transaction ERROR");if(!await y(a,a.objectStore("watchlist-"+e),null))throw new Error("Error clearing watchlist");t(!0)}catch(a){console.error("APP-DB-PROVIDER: clearWatchlist():",a.message||a||"Error"),t(!1)}})()}))),getTradeHistory:async(e,t,r)=>{(void 0===e||isNaN(Number(e)))&&(e=1);const a="ENTRY_TRADES"===r?0:"EXIT_TRADES"===r?1:null;return new Promise(((r,n)=>{(async()=>{try{const o=await m("trade-history","readonly");if(!o)throw new Error("Error initiating DB transaction");o.onabort=()=>n(o.error||"DB-transaction aborted"),o.onerror=()=>n(o.error||"DB-transaction ERROR");const l=await E(o,null!==a?o.objectStore("trade-history").index("type"):o.objectStore("trade-history"),e-1,t||20,a);r(l)}catch(o){console.error("APP-DB-PROVIDER: getTradeHistory():",o.message||o||"Error"),r(null)}})()}))},clearEntireTradeHistory:async()=>new Promise(((e,t)=>{(async()=>{try{const r=await m("trade-history","readwrite");if(!r)throw new Error("Error initiating DB transaction");r.onabort=()=>t(r.error||"DB-transaction aborted"),r.onerror=()=>t(r.error||"DB-transaction ERROR");if(!await y(r,r.objectStore("trade-history"),null))throw new Error("Error clearing trade-history");e(!0)}catch(r){console.error("APP-DB-PROVIDER: clearEntireTradeHistory():",r.message||r||"Error"),e(!1)}})()}))}},t)}},268:function(e,t,r){r.d(t,{A:function(){return n}});var a=r(6540);function n(e){let{children:t,fallback:r}=e;const{0:n,1:o}=(0,a.useState)(!1);return(0,a.useEffect)((()=>{o(!0)}),[]),n?a.createElement(a.Fragment,null,null==t?void 0:t()):null!=r?r:null}},4398:function(e,t,r){r.d(t,{j:function(){return je},A:function(){return We}});var a=r(6540),n=r(4794),o=r(9552),l=r(268),i=r(998),c=r(1298),s=r(5946),u=r(3654),m=r(7432),d=r(7616),w=r(6399),E="pagination-module--current--d9faf",h="pagination-module--paginationLinks--01e48",y="pagination-module--separator--0056b";function p(e){let{totalPages:t,currentPage:r,goToPage:n}=e;return 1<t&&a.createElement("div",{className:h},9<t?r<6?a.createElement(a.Fragment,null,a.createElement(b,{seriesStart:1,seriesEnd:r+2,currentPage:r,goToPage:n}),a.createElement("span",{className:y},"..."),a.createElement("button",{onClick:()=>{n(t)}},t)):r>t-5?a.createElement(a.Fragment,null,a.createElement("button",{onClick:()=>{n(1)}},"1"),a.createElement("span",{className:y},"..."),a.createElement(b,{seriesStart:r-2,seriesEnd:t,currentPage:r,goToPage:n})):a.createElement(a.Fragment,null,a.createElement("button",{onClick:()=>{n(1)}},"1"),a.createElement("span",{className:y},"..."),a.createElement(b,{seriesStart:r-2,seriesEnd:r+2,currentPage:r,goToPage:n}),a.createElement("span",{className:y},"..."),a.createElement("button",{onClick:()=>{n(t)}},t)):a.createElement(b,{seriesStart:1,seriesEnd:t,currentPage:r,goToPage:n}))}function b(e){let{seriesStart:t,seriesEnd:r,currentPage:n,goToPage:o}=e;return Array.from({length:r-t+1},((e,r)=>n===r+t?a.createElement("span",{key:`pn${r+t}`,className:E},n):a.createElement("button",{key:`pn${r+t}`,onClick:()=>{o(r+t)}},r+t)))}var g=r(6654),f=r(9611),v=r(214),D=r(7104),N="tradeHistoryItem-module--entry--ee69f",P="tradeHistoryItem-module--exit--b90ae",S="tradeHistoryItem-module--isEntry--39604",A="tradeHistoryItem-module--isExit--fd562",k="tradeHistoryItem-module--pnl--db19e",T="tradeHistoryItem-module--qty--d6167",B="tradeHistoryItem-module--tradeHistItem--ee27e";function I(e){let{tradeHistItem:t,...r}=e;if(0===t.typ){const{sbl:e,xh:n,qty:o,avg:l,dir:i,t:c}=t;return a.createElement("div",Object.assign({className:`${B} ${S}`},r),a.createElement(D.A,{tradingsymbol:e,exchange:n,isPositionSymbol:!0,isSellTrade:"S"===i}),a.createElement("span",{className:T},o),a.createElement("span",{className:N},l," ",c&&a.createElement("span",null,(0,v.bR)(new Date(c),!1,!0,!0,!0))))}if(1===t.typ){const{sbl:e,xh:n,qty:o,avg:l,dir:i,cp:c,t:s,x:u}=t,m=("S"===i?l-c:c-l)*o,d=(m/(l*o)*100).toFixed(2);return a.createElement("div",Object.assign({className:`${B} ${A}`},r),a.createElement(D.A,{tradingsymbol:e,exchange:n,isPositionSymbol:!0,isSellTrade:"S"===i}),a.createElement("span",{className:T},o),a.createElement(f.A,{className:k,currentVal:m,baseVal:0}),a.createElement(f.A,{currentVal:d,baseVal:0}),a.createElement("span",{className:N},l," ",s&&a.createElement("span",null,(0,v.bR)(new Date(s),!1,!0,!0,!0))),a.createElement("span",{className:P},c," ",u&&a.createElement("span",null,(0,v.bR)(new Date(u),!1,!0,!0,!0))))}return null}var R="tradeHistory-module--tradeHistC--cc1b2",C="tradeHistory-module--tradeHistFtr--71fe9",x="tradeHistory-module--tradeHistFtrCloseBtn--a917f",O="tradeHistory-module--tradeHistHdr--6744a",W="tradeHistory-module--tradeHistHdrTitleBar--7e26b",j="tradeHistory-module--tradeHistListC--00032",$="tradeHistory-module--tradeHistMain--0437b",L="tradeHistory-module--typeFilterTabsC--08f9e";function H(e){let{closeTradeHistory:t}=e;const{0:r,1:n}=(0,a.useState)(!0),{0:o,1:l}=(0,a.useState)([]),{0:i,1:E}=(0,a.useState)(0),{0:h,1:y}=(0,a.useState)(0),{0:b,1:f}=(0,a.useState)(1),{0:v,1:D}=(0,a.useState)(null),{0:N,1:P}=(0,a.useState)(!1),{notify:S}=(0,a.useContext)(c._),{getTradeHistory:A,clearEntireTradeHistory:k}=(0,a.useContext)(s.s),T=async e=>{try{n(!0);const t=await A(e||b,20,["ENTRY_TRADES","EXIT_TRADES"].includes(v)?v:null);if(!t)throw new Error("Trade history is empty");if(!Object.hasOwn(t,"records"))throw new Error;if(!Object.hasOwn(t,"totalPages"))throw new Error("Error inferring number of trades");return l(t.records),y(t.totalPages),E(t.totalRecords),!0}catch(t){return t&&console.error("TRADE-HISTORY: load():",t.message||t),l([]),!1}finally{n(!1)}};(0,a.useEffect)((()=>{(async()=>{await T()})()}),[b]);const B=(0,a.useRef)(!1);return(0,a.useEffect)((()=>{B.current?1!==b?f(1):(async()=>{await T(1)})():B.current=!0}),[v]),a.createElement(a.Fragment,null,a.createElement("div",{className:R},a.createElement("div",{className:$},a.createElement("div",{className:O},a.createElement("div",{className:W},a.createElement("h3",null,"Trade Records"),o.length>0?a.createElement(u.Ay,{variant:"tertiary",isDark:!0,icon:"broom-clean",onClick:P.bind(this,!0)}):a.createElement(u.Ay,{variant:"tertiary",isDark:!0,icon:"refresh-cw",onClick:()=>{(async()=>{await T()})()}})),!(o.length<1&&null==v)&&a.createElement("div",{className:L},a.createElement(d.A,{tabsAry:["All Trades","Entry Trades","Exit Trades"],selectedTab:"ENTRY_TRADES"===v?"Entry Trades":"EXIT_TRADES"===v?"Exit Trades":"All Trades",setSelectedTab:e=>{D("Entry Trades"===e?"ENTRY_TRADES":"Exit Trades"===e?"EXIT_TRADES":null)}}))),o.length<1?a.createElement(a.Fragment,null,a.createElement(w.A,{icon:"trade-history",note:`No ${"ENTRY_TRADES"===v?"entry-":"EXIT_TRADES"===v?"exit-":""}trades to Display`}),a.createElement(u.Ay,{className:x,variant:"tertiary",isDark:!0,size:"bigger",onClick:t},"Close")):a.createElement("div",{className:j},o.map(((e,t)=>a.createElement(I,{key:e.typ.toString()+e.sbl+t,tradeHistItem:e})))),h>1&&a.createElement("div",{className:C},a.createElement(p,{totalPages:h,currentPage:b,goToPage:f}))),r&&a.createElement(m.A,null)),N&&a.createElement(g.A,{confirmationNote:"Confirm deleting entire trade history?",doOnClose:()=>{P(!1)},doOnConfirm:()=>{(async()=>{try{if(n(!0),!await k())throw new Error;return l([]),y(0),E(0),f(1),D(null),!0}catch(e){return S(e.message||"Error clearing trade-history","err"),!1}finally{n(!1)}})().then((e=>{e&&t()}))},confirmBtnText:"Delete"}))}var F=r(4577),q="amount-module--amtC--47dfe",V="amount-module--amtCGreen--6be65",z="amount-module--amtCRed--bb39b",_="amount-module--amtCWhite--576fe";function M(e){let{amount:t,className:r,isColored:n=!1,isForDisplayingOverDarkBg:o=!1}=e;const l=(0,a.useMemo)((()=>t.toFixed(2).split(".")),[t]);return a.createElement("div",{className:`${q}${n&&0!==t?t>0?" "+V:" "+z:o?" "+_:""}${r&&""===(null==r?void 0:r.trim())?"":" "+r}`},a.createElement("span",null,Number(l[0]).toLocaleString("en-IN")),a.createElement("span",null,l[1]||"00"))}var K=r(2488),G=r(117),Y=r(2059),X="walletWithdrawInput-module--wltWthdrwNote--0c2b4";function U(e){let{doOnWithdraw:t,showVirtualAmtNotice:r=!1,className:n}=e;const{notify:o}=(0,a.useContext)(c._),{checkIfPlanActive:l}=(0,a.useContext)(G.R),{withdrawFromWallet:i,getWalletData:m}=(0,a.useContext)(s.s),{0:d,1:w}=(0,a.useState)("");return a.createElement("div",{className:n&&""!==(null==n?void 0:n.trim())?n:null},a.createElement(Y.Ay,{type:"number",name:"Withdrawal-amount",icon:"rupee-sign",placeholder:"Virtual amount",value:d,onChange:e=>{w(e.target.value)},actionPane:a.createElement(u.Ay,{variant:"primary",isDark:!0,onClick:()=>{(async()=>{await(async e=>{if(!e||"number"!=typeof e)return o("Kindly input a valid deposit amount","alert"),null;if(e<=0)return o("Deposit amount should be greater than 0","alert"),null;const r=await m(!0);if(null==r||!r.balance||(null==r?void 0:r.balance)<e)return o(`Wallet balance of ${null!=r&&r.balance?null==r?void 0:r.balance.toLocaleString("en-IN",{style:"currency",currency:"INR"}):"0"} is insufficient`,"alert"),null;try{if(!await l())throw new Error("Plan Expired!");const r=await i(e);if(!r)throw new Error;return null==t||t(r),o(`Successfully withdrew ${e.toLocaleString("en-IN",{style:"currency",currency:"INR"})} from wallet`,"success"),r}catch(a){return o(a.message||a||"Error withdrawing from wallet","err"),null}})(Number(d))&&w("")})()}},"Withdraw")}),r&&a.createElement("p",{className:X},"This is just virtual amount and not real currency. You can choose to withdraw any arbitrary virtual amount of your choice but this amount has no connection with real-world currency and thus would not be reflecting in your bank account."))}var J="walletTransactionRecord-module--amt--b3c8b",Q="walletTransactionRecord-module--credit--ae0e4",Z="walletTransactionRecord-module--debit--7e9b8",ee="walletTransactionRecord-module--deposit--85f20",te="walletTransactionRecord-module--dts--c2793",re="walletTransactionRecord-module--withdraw--6fe4f",ae="walletTransactionRecord-module--wltRecord--eda4c";function ne(e){let{transactionRecord:t,...r}=e;const{typ:n,amt:o,t:l}=t;let i="";switch(n){case 2:i=ee;break;case 0:i=Z;break;case 1:i=Q;break;case 3:i=re;break;default:return null}return a.createElement("div",Object.assign({className:`${ae} ${i}`},r),a.createElement("span",{className:te},(0,v.bR)(new Date(l),!1,!0,!0,!0)),a.createElement("span",{className:J},o.toLocaleString("en-IN",{maximumFractionDigits:2})))}var oe="walletTransactions-module--trnsctnsFilterTabsC--d6fda",le="walletTransactions-module--walletTransactionsListC--6b6bb",ie="walletTransactions-module--walletTrnsC--455ea",ce="walletTransactions-module--walletTrnsFtr--5284e",se="walletTransactions-module--walletTrnsFtrCloseBtn--1544a",ue="walletTransactions-module--walletTrnsHdr--aaaec",me="walletTransactions-module--walletTrnsHdrTitleBar--225ac",de="walletTransactions-module--walletTrnsMain--2d6bd";function we(e){let{onBackBtnClick:t,closeDialog:r}=e;const{0:n,1:o}=(0,a.useState)(!0),{0:l,1:i}=(0,a.useState)([]),{0:E,1:h}=(0,a.useState)(0),{0:y,1:b}=(0,a.useState)(0),{0:f,1:v}=(0,a.useState)(1),{0:D,1:N}=(0,a.useState)(null),{0:P,1:S}=(0,a.useState)(!1),{notify:A}=(0,a.useContext)(c._),{getWalletTransactionsHistory:k,clearEntireWalletTransactionsHistory:T}=(0,a.useContext)(s.s),B=async e=>{try{o(!0);const t=await k(e||f,20,["DEBIT","CREDIT","DEPOSIT","WITHDRAW"].includes(D)?D:null);if(!t)throw new Error("Error reading wallet transactions");if(!Object.hasOwn(t,"records"))throw new Error;if(!Object.hasOwn(t,"totalPages"))throw new Error("Error inferring number of transactions");return i(t.records),b(t.totalPages),h(t.totalRecords),!0}catch(t){return t&&console.error("WALLET-TRANSACTIONS: load():",t.message||"Error reading transactions"),i([]),!1}finally{o(!1)}};(0,a.useEffect)((()=>{(async()=>{await B()})()}),[f]);const I=(0,a.useRef)(!1);return(0,a.useEffect)((()=>{I.current?1!==f?v(1):(async()=>{await B(1)})():I.current=!0}),[D]),a.createElement(a.Fragment,null,a.createElement("div",{className:ie},a.createElement("div",{className:de},a.createElement("div",{className:ue},a.createElement("div",{className:me},t&&"function"==typeof t&&a.createElement(u.Ay,{variant:"tertiary",isDark:!0,icon:"arrow-left",onClick:t}),a.createElement("h3",null,"Wallet Transactions"),l.length>0?a.createElement(u.Ay,{variant:"tertiary",isDark:!0,icon:"broom-clean",onClick:S.bind(this,!0)}):a.createElement(u.Ay,{variant:"tertiary",isDark:!0,icon:"refresh-cw",onClick:()=>{(async()=>{await B(1)})()}})),!(l.length<1&&null==D)&&a.createElement("div",{className:oe},a.createElement(d.A,{tabsAry:["All","Debit","Credit","Deposit","Withdraw"],selectedTab:"DEBIT"===D?"Debit":"CREDIT"===D?"Credit":"DEPOSIT"===D?"Deposit":"WITHDRAW"===D?"Withdraw":"All",setSelectedTab:e=>{N("All"===e?null:e.toUpperCase())}}))),l.length<1?a.createElement(a.Fragment,null,a.createElement(w.A,{icon:"wallet",note:`No ${"DEBIT"===D?"debit ":"CREDIT"===D?"credit ":"DEPOSIT"===D?"deposit ":"WITHDRAW"===D?"withdrawal ":""}transactions to display`}),r&&"function"==typeof r&&a.createElement(u.Ay,{className:se,variant:"tertiary",isDark:!0,size:"bigger",onClick:r},"Close")):a.createElement("div",{className:le},l.map(((e,t)=>a.createElement(ne,{key:e.typ.toString()+e.t.toString()+t,transactionRecord:e})))),y>1&&a.createElement("div",{className:ce},a.createElement(p,{totalPages:y,currentPage:f,goToPage:v}))),n&&a.createElement(m.A,null)),P&&a.createElement(g.A,{confirmationNote:"Confirm deleting all transaction records?",doOnClose:()=>{S(!1)},doOnConfirm:()=>{(async()=>{try{if(o(!0),!await T())throw new Error;return i([]),b(0),h(0),v(1),N(null),!0}catch(e){return A(e.message||"Error clearing transactions","err"),!1}finally{o(!1)}})().then((e=>{e&&(null==t||t())}))},confirmBtnText:"Delete"}))}var Ee=r(4488),he="cumulativeSegmentedBookedPnL-module--segmentedBookedPnlT--738c8";function ye(){const{cumulativeBookedPnL:e}=(0,Ee.A)(),t=(0,a.useMemo)((()=>{let t=0;return Object.keys(e).forEach((r=>{t+=e[r]})),t}),[e]);return a.createElement("table",{className:he},a.createElement("colgroup",null,a.createElement("col",null),a.createElement("col",null)),a.createElement("thead",null,a.createElement("tr",null,a.createElement("th",null,"Segment"),a.createElement("th",null,"Booked P&L"))),a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",null,"Equity"),a.createElement("td",null,0!==e.eq&&a.createElement(f.A,{currentVal:e.eq,baseVal:0}))),a.createElement("tr",null,a.createElement("td",null,"Fut & Opt"),a.createElement("td",null,0!==e.fno&&a.createElement(f.A,{currentVal:e.fno,baseVal:0}))),a.createElement("tr",null,a.createElement("td",null,"Commodity"),a.createElement("td",null,0!==e.com&&a.createElement(f.A,{currentVal:e.com,baseVal:0}))),a.createElement("tr",null,a.createElement("td",null,"Currency"),a.createElement("td",null,0!==e.cd&&a.createElement(f.A,{currentVal:e.cd,baseVal:0})))),a.createElement("tfoot",null,a.createElement("tr",null,a.createElement("td",null,"Net"),a.createElement("td",null,a.createElement(f.A,{currentVal:t,baseVal:0})))))}var pe="wallet-module--amtInvestedInPosCardC--1fa27",be="wallet-module--netBookedPnLCardC--cbebd",ge="wallet-module--netBookedPnLCardCLoss--e0ca9",fe="wallet-module--netBookedPnLCardCProfit--0408d",ve="wallet-module--walletC--29412",De="wallet-module--walletCardC--f9c07",Ne="wallet-module--walletDepositWithdrawInputC--abbe7",Pe="wallet-module--withdrawDepositCtaC--0ea36";const Se={WALLET:0,TRANSACTIONS:1,DEPOSIT:2,WITHDRAW:3,SEG_BOOKED_PNL:4};function Ae(e){let{closeDialog:t}=e;const{0:r,1:n}=(0,a.useState)(Se.WALLET);return r===Se.TRANSACTIONS?a.createElement(we,{onBackBtnClick:n.bind(null,Se.WALLET),closeDialog:t}):r===Se.DEPOSIT?a.createElement(F.A,{title:"Deposit Virtual Amount",onGoBackClick:n.bind(null,Se.WALLET)},a.createElement(a.Fragment,null,a.createElement(K.A,{doOnDeposit:e=>{n(Se.WALLET)},showVirtualAmtNotice:!0,className:Ne}),a.createElement(u.Ay,{variant:"tertiary",icon:"arrow-left",isDark:!0,onClick:n.bind(null,Se.WALLET)},"Back to Wallet"))):r===Se.WITHDRAW?a.createElement(F.A,{title:"Withdraw Virtual Amount",onGoBackClick:n.bind(null,Se.WALLET)},a.createElement(a.Fragment,null,a.createElement(U,{doOnWithdraw:e=>{n(Se.WALLET)},showVirtualAmtNotice:!0,className:Ne}),a.createElement(u.Ay,{variant:"tertiary",icon:"arrow-left",isDark:!0,onClick:n.bind(null,Se.WALLET)},"Back to Wallet"))):r===Se.SEG_BOOKED_PNL?a.createElement(F.A,{title:"Booked P&L by Segment",onGoBackClick:n.bind(null,Se.WALLET)},a.createElement(ye,null)):a.createElement(ke,{setCurrentPage:n})}function ke(e){let{setCurrentPage:t}=e;const{walletBalance:r,cumulativeDeposit:n,cumulativeWithdrawal:l,amtInvestedInPositions:i,cumulativeBookedPnL:c,reFetch:s}=(0,Ee.A)(),m=(0,a.useMemo)((()=>Math.round(100*i/(i+r))),[r,i]),d=(0,a.useMemo)((()=>{let e=0;return Object.keys(c).forEach((t=>{e+=c[t]})),e}),[c]);return a.createElement("div",{className:ve},a.createElement("div",{className:De},a.createElement(M,{amount:r,isForDisplayingOverDarkBg:!0}),a.createElement(u.Ay,{variant:"tertiary",size:"small",isDark:!0,onClick:t.bind(null,Se.TRANSACTIONS)},"View Transactions"),a.createElement("div",{className:Pe},a.createElement(u.Ay,{variant:"secondary",isDark:!0,onClick:t.bind(null,Se.WITHDRAW)},"Withdraw"),a.createElement(u.Ay,{variant:"primary",isDark:!0,onClick:t.bind(null,Se.DEPOSIT)},"Deposit"))),i>0&&a.createElement("div",{className:pe},a.createElement(M,{amount:i}),a.createElement("span",null,m)),0===d?a.createElement("div",{className:be},a.createElement(M,{amount:0})):a.createElement("button",{className:`${be} ${d<0?ge:fe}`,onClick:t.bind(null,Se.SEG_BOOKED_PNL)},a.createElement(M,{amount:d,isColored:!0}),a.createElement(o.A,{icon:"chevron-right"})))}var Te="header-module--active--0b6dd",Be="header-module--hdr--ed9b0",Ie="header-module--logoC--2127a",Re="header-module--navMenu--ff5f0",Ce="header-module--prominent--749fc",xe="header-module--svgNavMenuCornerTopLeft--5957a",Oe="header-module--svgNavMenuCornerTopRight--a94ce";function We(){return a.createElement("header",{id:Be},a.createElement("div",{id:Ie},a.createElement(n.Link,{to:"/"},a.createElement("img",{src:"/img/logo.svg",alt:"Kaagzi"}))),a.createElement("nav",{id:Re},a.createElement("svg",{className:xe,x:"0px",y:"0px",viewBox:"0 0 32 32"},a.createElement("path",{d:"M0,0v32h32C14.3,32,0,17.7,0,0z"})),a.createElement("svg",{className:Oe,x:"0px",y:"0px",viewBox:"0 0 32 32"},a.createElement("path",{d:"M0,32h32V0C32,17.7,17.7,32,0,32z"})),a.createElement("ul",null,a.createElement("li",null,a.createElement(n.Link,{activeClassName:Te,to:"/"},a.createElement(o.A,{icon:"home2"}),a.createElement("span",null,"Home"))),a.createElement("li",null,a.createElement(n.Link,{activeClassName:Te,to:"/pricing"},a.createElement(o.A,{icon:"rupee-sign"}),a.createElement("span",null,"Pricing"))),a.createElement("li",{className:Ce},a.createElement(n.Link,{activeClassName:Te,partiallyActive:!0,to:"/app"},a.createElement("div",null,a.createElement(o.A,{icon:"smartphone"})),a.createElement("span",null,"App"))),a.createElement("li",null,a.createElement(n.Link,{activeClassName:Te,partiallyActive:!0,to:"/guide"},a.createElement(o.A,{icon:"book-open"}),a.createElement("span",null,"Guide"))),a.createElement("li",null,a.createElement(l.A,null,(()=>{const e=r(6872).Ay;return a.createElement(e,null)}))))))}function je(e){let{broker:t,brokerLoggedInUserName:c,brokerLogOut:s,doOnWatchListBtnClick:u}=e;const{0:m,1:d}=(0,a.useState)(!1),{0:w,1:E}=(0,a.useState)(!1),{checkIfLoginSessionIsValid:h,checkIfPlanActive:y}=(0,a.useContext)(G.R);return a.createElement(a.Fragment,null,a.createElement("header",{id:Be},a.createElement("div",{id:Ie},a.createElement(n.Link,{to:"/app"},a.createElement("img",{src:"/img/logo.svg",alt:"Kaagzi"}))),a.createElement("nav",{id:Re},a.createElement("svg",{className:xe,x:"0px",y:"0px",viewBox:"0 0 32 32"},a.createElement("path",{d:"M0,0v32h32C14.3,32,0,17.7,0,0z"})),a.createElement("svg",{className:Oe,x:"0px",y:"0px",viewBox:"0 0 32 32"},a.createElement("path",{d:"M0,32h32V0C32,17.7,17.7,32,0,32z"})),a.createElement("ul",null,a.createElement("li",{key:"apphdrwlt"},a.createElement("button",{onClick:E.bind(null,!0)},a.createElement(o.A,{icon:"wallet"}),a.createElement("span",null,"Wallet"))),a.createElement("li",{key:"apphdrwtchlst"},a.createElement("button",{onClick:async()=>{await h()&&await y()&&u()}},a.createElement(o.A,{icon:"binocular"}),a.createElement("span",null,"Watchlist"))),a.createElement("li",{key:"apphdrhstry"},a.createElement("button",{onClick:d.bind(null,!0)},a.createElement(o.A,{icon:"trade-history"}),a.createElement("span",null,"History"))),a.createElement("li",{key:"apphdrusrdd"},a.createElement(l.A,null,(()=>{const e=r(6872).Ay;return a.createElement(e,{broker:t,brokerLoggedInUserName:c,brokerLogOut:s})})))))),m&&a.createElement(i.A,{doOnClose:d.bind(null,!1)},(e=>a.createElement(H,{closeTradeHistory:e}))),w&&a.createElement(i.A,{doOnClose:E.bind(null,!1)},(e=>a.createElement(Ae,{closeDialog:e}))))}},8719:function(e,t,r){r.d(t,{A:function(){return o},y:function(){return l}});var a=r(6540),n=r(4293);function o(e){let{title:t,description:r,featuredImage:o,urlPath:l,children:i}=e;const{siteName:c,title:s,description:u,featuredImage:m,siteUrl:d,favicon:w,themeColor:E}=(0,n.A)(),h=`${d}${l||""}`,y=t?c+" - "+t:s,p=r||u,b=`${d}${o||m}`;return a.createElement(a.Fragment,null,a.createElement("title",null,y),a.createElement("meta",{name:"description",content:p}),a.createElement("meta",{name:"image",content:b}),a.createElement("link",{rel:"icon",href:w,type:"image/x-icon"}),a.createElement("link",{rel:"canonical",href:h}),a.createElement("meta",{name:"theme-color",content:E}),a.createElement("meta",{property:"og:title",content:y}),a.createElement("meta",{property:"og:description",content:p}),a.createElement("meta",{property:"og:image",content:b}),a.createElement("meta",{property:"og:url",content:h}),a.createElement("script",{type:"application/ld+json"},JSON.stringify({"@context":"https://schema.org","@type":"OnlineBusiness","@id":"https://kaagzi.in#org",image:`${d}${m}`,url:"https://kaagzi.in",sameAs:["https://www.instagram.com/_kaagzi/","https://www.facebook.com/kaagzi/","https://www.youtube.com/@Kaagzi"],logo:"https://kaagzi.in/img/kaagzi-logo.webp",name:"Kaagzi",description:u,email:"kaagzi.in@gmail.com",telephone:"+91-9321266694",contactPoint:{contactType:"Customer Service",email:"kaagzi.in@gmail.com",telephone:"+91-9321266694"},address:{"@type":"PostalAddress",streetAddress:"A/1, Milap, Navagaon",addressLocality:"Mumbai",addressCountry:"IN",addressRegion:"Dahisar West",postalCode:"400068"},founder:{"@type":"Person",name:"Nimish Rajwade",sameAs:["https://www.instagram.com/nimish.rajwade/","https://www.facebook.com/nimish.rajwade/"]}})),a.createElement("script",{type:"application/ld+json"},JSON.stringify({"@context":"https://schema.org/","@type":"WebSite","@id":"https://kaagzi.in#website",name:"Kaagzi",url:"https://kaagzi.in/",publisher:{"@id":"https://kaagzi.in#org"}})),a.createElement("script",{type:"application/ld+json"},JSON.stringify({"@context":"https://schema.org/","@type":"WebPage",name:y,headline:y,description:p,url:h,isPartOf:{"@id":"https://kaagzi.in#website"},publisher:{"@id":"https://kaagzi.in#org"}})),a.createElement("script",{type:"application/ld+json"},JSON.stringify({"@context":"https://schema.org","@type":["WebApplication","MobileApplication"],name:"Kaagzi",operatingSystem:["Android","iOS","Windows"],applicationCategory:"FinanceApplication",installUrl:"https://kaagzi.in/app",aggregateRating:{"@type":"AggregateRating",ratingValue:"4.9",ratingCount:"369"},offers:{"@type":"Offer",price:"75.00",priceCurrency:"INR",eligibleRegion:{"@type":"Country",name:"IN"}},copyrightHolder:{"@type":"Person",name:"Nimish Rajwade",sameAs:["https://www.instagram.com/nimish.rajwade/","https://www.facebook.com/nimish.rajwade/"]},creator:{"@id":"https://kaagzi.in#org"},publisher:{"@id":"https://kaagzi.in#org"}})),"function"==typeof i?null==i?void 0:i(d):i)}function l(e){let{title:t,description:r,children:o}=e;const{siteName:l,title:i,description:c,favicon:s,themeColor:u}=(0,n.A)(),m=t?l+" - "+t:i,d=r||c;return a.createElement(a.Fragment,null,a.createElement("title",null,m),a.createElement("meta",{name:"description",content:d}),a.createElement("link",{rel:"icon",href:s,type:"image/x-icon"}),a.createElement("meta",{name:"theme-color",content:u}),a.createElement("meta",{property:"og:title",content:m}),a.createElement("meta",{property:"og:description",content:d}),a.createElement("meta",{name:"robots",content:"noindex"}),o)}},6399:function(e,t,r){r.d(t,{A:function(){return c}});var a=r(6540),n=r(3654),o=r(9552),l="emptyGfx-module--emptyGfxC--d59ee",i="emptyGfx-module--isOverlay--0dd71";function c(e){let{icon:t,note:r,ctaFn:c,ctaBtnText:s,isOverlay:u,className:m}=e;return a.createElement("div",{className:`${l}${u?" "+i:""}${m&&""!==m.trim()?" "+m:""}`},a.createElement("div",null,a.createElement(o.A,{icon:t}),r&&a.createElement("div",null,r),c&&"function"==typeof c&&a.createElement(n.Ay,{variant:"primary",isDark:!0,onClick:c},s||"Load")))}},7616:function(e,t,r){r.d(t,{A:function(){return l}});var a=r(6540),n="radioTabs-module--radioTabsC--1c522",o="radioTabs-module--selected--2448f";function l(e){let{tabsAry:t,selectedTab:r,setSelectedTab:l,className:i}=e;return t&&Array.isArray(t)?a.createElement("div",{className:`${n}${i&&""!==i.trim()?" "+i:""}`},t.map((e=>a.createElement("button",{key:e,className:e===r?o:null,onClick:l.bind(this,e)},e)))):null}},998:function(e,t,r){r.d(t,{A:function(){return d}});var a=r(6540),n=r(961),o=r(4794),l=r(4164),i="bottomSheet-module--bg--03bd7",c="bottomSheet-module--isViz--5e820",s="bottomSheet-module--sheet--61b70",u="bottomSheet-module--wrap--ff172",m="bottomSheet-module--xBtn--b7c80";function d(e){let{title:t,desc:r,useCloseBtn:d,doNotCloseIfClickedOnBackdrop:w,doOnOpen:E,doOnClose:h,children:y}=e;const{0:p,1:b}=(0,a.useState)(!1),{0:g,1:f}=(0,a.useState)(t||""),{0:v,1:D}=(0,a.useState)(r||""),N=(0,a.useRef)(Math.random().toString(36).substring(2,11)),P=e=>{var t;e.state&&(null===(t=e.state)||void 0===t?void 0:t.btmSheet)===N.current&&S()},S=()=>{b(!1),setTimeout((()=>{document&&document.body&&(document.body.style.overflow="visible"),window&&window.removeEventListener("popstate",P),h&&"function"==typeof h&&h()}),300)},A=()=>{(0,o.navigate)(-1),S()};return(0,a.useEffect)((()=>(document&&document.body&&(document.body.style.overflow="hidden"),window&&window.addEventListener("popstate",P),p||((0,o.navigate)("",{state:{btmSheet:N.current},replace:!0}),setTimeout((()=>{(0,o.navigate)("")}),300)),setTimeout((()=>{b(!0),E&&"function"==typeof E&&setTimeout((()=>{E()}),300)}),10),()=>{document&&document.body&&(document.body.style.overflow="visible"),window&&window.removeEventListener("popstate",P)})),[]),(0,n.createPortal)(a.createElement("div",{className:(0,l.A)(u,p&&c)},d||w?a.createElement("div",{className:i}):a.createElement("div",{className:i,onClick:A}),a.createElement("div",{className:s},(g||r)&&a.createElement("header",null,g&&a.createElement("div",null,g),v&&""!==v.trim()&&a.createElement("div",null,v)),a.createElement("main",null,"function"==typeof y?y(A,f,D):y),d&&a.createElement("button",{className:m,onClick:A},"✖"))),document.body)}}}]);